[changelog]
# template for the changelog body
# https://tera.netlify.app/docs/#introduction
body = """
{% if version %}
    ## [{{ version | trim_start_matches(pat="v") }}] - {{ timestamp | date(format="%Y-%m-%d") }}
{% else %}
    ## [unreleased]
{% endif %}
{% set breakings = commits | filter(attribute="breaking", value=true) -%}
{% set deprecations = commits | filter(attribute="breaking", value=false) | filter(attribute="group", value="deprecate") -%}
{% set features = commits | filter(attribute="breaking", value=false) | filter(attribute="group", value="feat") -%}
{% set fixes = commits | filter(attribute="breaking", value=false) | filter(attribute="group", value="fix") -%}
{% set perfs = commits | filter(attribute="breaking", value=false) | filter(attribute="group", value="perf") -%}
{% set docs = commits | filter(attribute="breaking", value=false) | filter(attribute="group", value="doc") -%}
{% if breakings %}
    ### ⚠ Breaking changes ⚠
    {% for commit in breakings %}
        * {% if commit.scope %}**{{commit.scope}}):** {% endif %}{{ commit.message | upper_first }}
    {% endfor %}
{% endif -%}
{% if features %}
    ### Features
    {% for commit in features %}
        * {% if commit.scope %}**{{commit.scope}}:** {% endif %}{{ commit.message | upper_first }}
    {% endfor %}
{% endif -%}
{% if fixes %}
    ### Fixes
    {% for commit in fixes %}
        * {% if commit.scope %}**{{commit.scope}}:** {% endif %}{{ commit.message | upper_first }}
    {% endfor %}
{% endif -%}
{% if perfs %}
    ### Performance
    {% for commit in perfs %}
        * {% if commit.scope %}**{{commit.scope}}:** {% endif %}{{ commit.message | upper_first }}
    {% endfor %}
{% endif -%}
{% if docs %}
    ### Documentation
    {% for commit in docs %}
        * {% if commit.scope %}**{{commit.scope}}:** {% endif %}{{ commit.message | upper_first }}
    {% endfor %}
{% endif -%}
"""

[git]
conventional_commits = true
filter_unconventional = true
protect_breaking_commits = true
filter_commits = true
tag_pattern = "v[0-9]*"
commit_parsers = [
    { message = "^deprecate", group = "deprecate"},
    { message = "^feat", group = "feat"},
    { message = "^fix", group = "fix"},
    { message = "^perf", group = "perf"},
    { message = "^doc", group = "doc"},
]
link_parsers = [
    { pattern = "#(\\d+)", href = "https://github.com/jcornaz/beancount-parser/pulls/$1" },
]
